<!DOCTYPE html>
<html lang="pt-BR" class="glideajax-root">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ServiceNow: GlideAjax Best Practices</title>
    <meta name="description" content="GlideAjax descomplicado com analogias práticas, guia passo a passo e simulador visual.">
    <link rel="icon" type="image/svg+xml" href="../../favicon.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../../css/base.css">
    <link rel="stylesheet" href="../../css/components.css">
    <link rel="stylesheet" href="../../css/pages.css">
    <link rel="stylesheet" href="../../css/glideajax.css">
    <meta property="og:title" content="ServiceNow: GlideAjax Best Practices">
    <meta property="og:description" content="Guia completo de GlideAjax com analogias práticas e laboratório interativo para ServiceNow.">
    <meta property="og:image" content="https://brandao.sn/images/Perfil%20Brandao.jpg">
    <meta property="og:url" content="https://brandao.sn/estudos/glideajax/">
    <meta property="og:type" content="article">
    <link rel="alternate" hreflang="pt-br" href="https://brandao.sn/estudos/glideajax/">
    <link rel="alternate" hreflang="en" href="https://brandao.sn/en/estudos/glideajax/">
</head>
<body class="glideajax-page" data-base-path="../../" data-route="estudos" data-lang-slug="estudos/glideajax/">

<div class="blur-overlay" id="blur-overlay"></div>
<div id="particles"></div>

<div data-include="header"></div>

<div id="page-content">
    <div class="content-wrapper">
        <main>
            <div class="glideajax-container">

    <!-- Article Intro -->
    <section class="card article-intro">
        <div class="intro-header">
            <div class="icon-box bg-concept"><i class="fa-solid fa-pen-nib"></i></div>
            <div>
                <p class="intro-label">Guia prático ServiceNow</p>
                <h2>GlideAjax Descomplicado</h2>
            </div>
        </div>
        <p class="intro-description">
            Aprenda GlideAjax com analogias simples e um laboratório visual para entender a troca entre Client Script, GlideAjax e Script Include.
        </p>
        <div class="intro-meta">
            <span><i class="fa-solid fa-user-pen"></i> Itallo Brandão</span>
            <span><i class="fa-solid fa-calendar"></i> 28 nov 2025</span>
        </div>
    </section>

    <!-- Low-code Awareness Section -->
    <section class="card concept best-practices">
        <h2>
            <div class="icon-box bg-gold"><i class="fa-solid fa-triangle-exclamation"></i></div>
            Primeiro: existe algo Low-code ou OOTB?
        </h2>
        <p class="ga-text-muted ga-mb-sm">
            Antes de abrir o editor e codar um GlideAjax ou qualquer solução hardcode, faça uma checagem honesta: a plataforma já não resolve isso sozinha? Muitas vezes um <strong>Flow Designer</strong>, <strong>Integration Hub</strong>, <strong>Data Lookup</strong> ou mesmo um componente OOTB entrega 80% (ou 100%) da demanda com bem menos esforço e manutenção.
        </p>
        <ul class="step-list">
            <li class="step-item">
                <div class="step-num">1</div>
                <div class="step-content">
                    <strong>Mapeie o requisito:</strong> descreva claramente o que o usuário precisa, o contexto do processo e as regras já existentes.
                </div>
            </li>
            <li class="step-item">
                <div class="step-num">2</div>
                <div class="step-content">
                    <strong>Faça o inventário de opções:</strong> revise catálogos OOTB, apps do Store e recursos low-code antes de desenhar uma arquitetura custom.
                </div>
            </li>
            <li class="step-item">
                <div class="step-num">3</div>
                <div class="step-content">
                    <strong>Justifique o custom:</strong> se ainda assim precisar codar, documente os motivos (lacunas funcionais, performance, compliance) e siga com segurança.
                </div>
            </li>
        </ul>
        <p class="ga-text-muted">
            Essa disciplina economiza tempo, garante alinhamento com as boas práticas ServiceNow e evita legados desnecessários. Quando o OOTB/low-code não cobre, aí sim partimos para o hardcode e soluções personalizadas.
        </p>
    </section>

    <section class="card ga-note">
        <h2>
            <div class="icon-box bg-gold"><i class="fa-solid fa-triangle-exclamation"></i></div>
            Importante
        </h2>
        <p class="ga-text-muted">
            Para fins didáticos, utilizei um cenário simplificado: buscar o e-mail do usuário via script. É importante ressaltar que, em um projeto real, essa necessidade específica seria resolvida sem código, utilizando a funcionalidade nativa de Dot-Walking (exibir campos de tabelas relacionadas). Porém, escolhi este cenário pela sua clareza e baixa complexidade, permitindo focar 100% na sintaxe e estrutura do GlideAjax, sem a distração de regras de negócio complexas.
        </p>
    </section>

    <!-- GlideAjax Purpose Section -->
    <section class="card concept">
        <h2>
            <div class="icon-box bg-concept"><i class="fa-solid fa-sitemap"></i></div>
            Para que serve o GlideAjax?
        </h2>
    <p class="ga-text-muted ga-mb-sm">
            O GlideAjax é a ponte segura entre o <strong>Client Script</strong> e o <strong>Script Include</strong>. Ele permite
            buscar dados do servidor sem travar a interface, obedecendo ACLs e reduzindo chamadas desnecessárias ao backend.
        </p>
        <ul class="step-list">
            <li class="step-item">
                <div class="step-num">1</div>
                <div class="step-content">
                    <strong>Performance:</strong> realiza chamadas assíncronas e mantém o usuário trabalhando enquanto a resposta vem.
                </div>
            </li>
            <li class="step-item">
                <div class="step-num">2</div>
                <div class="step-content">
                    <strong>Segurança:</strong> respeita as ACLs configuradas no Script Include e impede acesso direto ao banco.
                </div>
            </li>
            <li class="step-item">
                <div class="step-num">3</div>
                <div class="step-content">
                    <strong>Flexibilidade:</strong> retorna textos, objetos JSON ou qualquer dado que o cliente precise renderizar.
                </div>
            </li>
        </ul>
    </section>

    <!-- Concept Section -->
    <section class="card concept">
        <h2>
            <div class="icon-box bg-concept"><i class="fa-solid fa-lightbulb"></i></div>
            Conceito: O Garçom Assíncrono
        </h2>
    <p class="ga-text-muted ga-mb-md">
            O navegador (Client Side) <strong>não pode</strong> acessar o banco de dados diretamente por segurança e performance. 
            Para buscar dados no servidor sem recarregar a página ou travar a tela, usamos o <strong>GlideAjax</strong> como um intermediário.
        </p>
        
        <div class="analogy-container">
            <div class="analogy-step">
                <i class="fa-solid fa-desktop fa-2x icon-client"></i>
                <p><strong>1. Cliente (Mesa)</strong><br><span class="analogy-note">Você (Client Script) faz o pedido da mesa. Não tem acesso direto à cozinha (Banco de Dados).</span></p>
            </div>
            <div class="analogy-arrow"><i class="fa-solid fa-arrow-right"></i></div>
            <div class="analogy-step">
                <i class="fa-solid fa-bell-concierge fa-2x icon-neutral"></i>
                <p><strong>2. GlideAjax (Garçom)</strong><br><span class="analogy-note">Leva o pedido (Parâmetros) e traz o prato (XML/JSON). O cliente continua conversando enquanto espera (Assíncrono).</span></p>
            </div>
            <div class="analogy-arrow"><i class="fa-solid fa-arrow-right"></i></div>
            <div class="analogy-step">
                <i class="fa-solid fa-database fa-2x icon-server"></i>
                <p><strong>3. Servidor (Cozinha)</strong><br><span class="analogy-note">O Chef (Script Include) recebe o pedido, consulta o estoque (DB) com segurança e prepara a resposta.</span></p>
            </div>
        </div>
    </section>

    <!-- LIVE SIMULATOR -->
    <section class="card lab-card">
        <h2>
            <div class="icon-box bg-navy"><i class="fa-solid fa-play"></i></div>
            Laboratório Interativo de GlideAjax
        </h2>
        <p class="ga-mb-md">
            Teste o GlideAjax abaixo. Altere o campo <strong>Caller</strong> e observe a animação da cozinha acontecendo em tempo real com os logs.
        </p>
        
        <div class="alert-box alert-expanded">
            <div>
                <strong><i class="fa-solid fa-triangle-exclamation"></i> Atenção:</strong> O simulador abaixo é apenas uma representação visual para fins didáticos (HTML/JS puro). O código real de GlideAjax só funciona dentro de uma instância ServiceNow.
            </div>
        </div>

        <!-- SN FORM MOCKUP -->
        <div class="sn-form-container">
            <div class="sn-form-header">
                <span class="sn-form-title">Incident: INC0010042 (New Record)</span>
                <div class="sn-btn-group">
                    <button class="sn-btn sn-btn-primary">Submit</button>
                    <button class="sn-btn">Resolve</button>
                </div>
            </div>
            <div class="sn-form-body">
                <!-- Field: Number (Readonly) -->
                <div class="sn-field-row">
                    <label class="sn-label">Number</label>
                    <div class="sn-input-group">
                        <input type="text" class="sn-input readonly" value="INC0010042" readonly>
                    </div>
                </div>

                <!-- Field: Caller (Reference / Trigger) -->
                <div class="sn-field-row">
                    <label class="sn-label">Caller <span class="required-indicator">*</span></label>
                    <div class="sn-input-group">
                        <div class="sn-ref-wrapper">
                            <select id="caller_id" class="sn-input sn-select-fake" onchange="startSimulation(this.value)">
                                <option value="" selected>-- Select --</option>
                                <option value="abel">Abel Tuter</option>
                                <option value="abraham">Abraham Lincoln</option>
                                <option value="system">System Administrator</option>
                            </select>
                            <div id="field-spinner" class="field-loader"></div>
                            <i class="fa-solid fa-magnifying-glass sn-ref-icon"></i>
                        </div>
                    </div>
                </div>

                <!-- Field: Email (Target) -->
                <div class="sn-field-row">
                    <label class="sn-label">Caller Email</label>
                    <div class="sn-input-group">
                        <input type="text" id="u_email" class="sn-input readonly" placeholder="(Aguardando GlideAjax...)" readonly>
                    </div>
                </div>
                
                 <!-- Field: Short Description -->
                 <div class="sn-field-row">
                    <label class="sn-label">Short description</label>
                    <div class="sn-input-group">
                        <input type="text" class="sn-input" value="Need help with email setup">
                    </div>
                </div>

            </div>
            
            <!-- DEBUG PANELS -->
            <div class="debug-console">
                <div class="debug-header">
                    <span><i class="fa-solid fa-bug"></i> Debug Timeline</span>
                    <div class="debug-controls">
                        <!-- Step Controls -->
                        <div id="step-controls">
                            <button class="step-btn" onclick="manualStep(-1)" title="Anterior"><i class="fa-solid fa-backward-step"></i></button>
                            <button class="step-btn" onclick="manualStep(1)" title="Próximo"><i class="fa-solid fa-forward-step"></i></button>
                        </div>

                        <select id="speed-control" class="speed-select" title="Velocidade da simulação" onchange="toggleControls()">
                            <option value="0.5" selected>Automático</option>
                            <option value="step">Manual</option>
                        </select>
                        <button class="debug-btn" onclick="resetAll()" title="Limpar logs"><i class="fa-solid fa-trash"></i></button>
                    </div>
                </div>
                <div class="timeline-container" id="debug-timeline">
                    <div class="timeline-placeholder">
                        <i class="fa-regular fa-comments fa-2x"></i><br>
                        Aguardando alteração no formulário...
                    </div>
                </div>

                <!-- VISUAL ANIMATION AREA -->
                <div class="animation-stage">
                    <div class="path-line"></div>
                    
                    <!-- Client Actor -->
                    <div class="anim-actor actor-client">
                        <div id="bubble-client" class="speech-bubble">Quero o email!</div>
                        <div class="anim-role">Cliente</div>
                        <div class="anim-icon"><i class="fa-solid fa-user"></i></div>
                        <div class="anim-tech">Client Script</div>
                    </div>

                    <!-- Waiter (Moving) -->
                    <div id="anim-waiter" class="anim-actor actor-waiter">
                        <div id="bubble-waiter" class="speech-bubble">Indo buscar!</div>
                        <div class="anim-role">Garçom</div>
                        <div class="anim-icon"><i class="fa-solid fa-bell-concierge"></i></div>
                        <div class="anim-tech">GlideAjax</div>
                    </div>

                    <!-- Server Actor -->
                    <div class="anim-actor actor-server">
                        <div id="bubble-server" class="speech-bubble">Procurando...</div>
                        <div class="anim-role">Cozinheiro</div>
                        <div id="anim-cook" class="anim-icon"><i class="fa-solid fa-fire-burner"></i></div>
                        <div class="anim-tech">Script Include</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="card simulator-warning simulator-rotate-warning" aria-live="polite">
        <h2>
            <div class="icon-box bg-navy"><i class="fa-solid fa-mobile-screen-button"></i></div>
            Gire a tela para acessar o simulador
        </h2>
        <p>
            Estamos quase lá! Este dispositivo tem altura suficiente, então basta colocar o aparelho na horizontal para liberar o
            laboratório interativo de GlideAjax.
        </p>
    </section>

    <section class="card simulator-warning simulator-desktop-warning" aria-live="polite">
        <h2>
            <div class="icon-box bg-navy"><i class="fa-solid fa-desktop"></i></div>
            Simulador disponível apenas em telas grandes
        </h2>
        <p>
            Para experimentar o laboratório interativo, abra este conteúdo em um dispositivo com pelo menos 900&nbsp;px de altura
            (desktop, notebook ou tablet em modo paisagem). Você ainda pode seguir todo o guia teórico normalmente no mobile.
        </p>
    </section>

    <!-- SERVER SIDE -->
    <section class="card server">
        <h2>
            <div class="icon-box bg-server"><i class="fa-solid fa-server"></i></div>
            Passo 1: O Backend (Script Include)
        </h2>
        
        <h3>Como criar no ServiceNow</h3>
        <ul class="step-list">
            <li class="step-item">
                <div class="step-num">1</div>
                <div class="step-content">Navegue até <strong>System Definition > Script Includes</strong>.</div>
            </li>
            <li class="step-item">
                <div class="step-num">2</div>
                <div class="step-content">Clique em <strong>New</strong>.</div>
            </li>
            <li class="step-item">
                <div class="step-num">3</div>
                <div class="step-content">Defina o <strong>Name</strong> (Ex: <span class="highlight-nav">UserDataHelper</span>). Guarde este nome!</div>
            </li>
            <li class="step-item">
                <div class="step-num">4</div>
                <div class="step-content">
                    <span class="highlight-ui">IMPORTANTE:</span> Marque a caixa <strong>Client callable</strong>. Se não marcar, o navegador não consegue acessar esse script.
                </div>
            </li>
        </ul>

        <div class="code-wrapper">
            <div class="code-header">
                <div class="code-header-info">
                    <span>Script Include: UserDataHelper</span>
                    <span>Server-Side (Javascript)</span>
                </div>
                <button type="button" class="code-copy-btn" aria-label="Copiar código">
                    <i class="fa-regular fa-copy"></i>
                    <span class="copy-label">Copiar código</span>
                </button>
            </div>
            <pre><code><span class="kwd">var</span> <span class="cls">UserDataHelper</span> = <span class="cls">Class</span>.create();
<span class="cls">UserDataHelper</span>.prototype = <span class="cls">Object</span>.extendsObject(<span class="cls">AbstractAjaxProcessor</span>, {

    <span class="com">// Nome da função que chamaremos no cliente</span>
    <span class="fn">getEmail</span>: <span class="kwd">function</span>() {
        
        <span class="com">// 1. Captura o parâmetro (padrão snake_case por convenção)</span>
        <span class="kwd">var</span> userId = <span class="kwd">this</span>.getParameter(<span class="str">'sysparm_user_id'</span>);
        <span class="kwd">if</span> (!userId) <span class="kwd">return</span> <span class="str">''</span>;
        
        <span class="com">// 2. Use GlideRecord para consultar a tabela alvo</span>
        <span class="kwd">var</span> gr = <span class="kwd">new</span> <span class="cls">GlideRecord</span>(<span class="str">'sys_user'</span>);
        
        <span class="kwd">if</span> (gr.get(userId)) {
            <span class="com">// 3. Retorna o valor usando getValue (Mais performático)</span>
            <span class="kwd">return</span> gr.getValue(<span class="str">'email'</span>) || <span class="str">''</span>;
        }
        
        <span class="kwd">return</span> <span class="str">''</span>;
    },

    type: <span class="str">'UserDataHelper'</span>
});</code></pre>
        </div>
    </section>

    <!-- CLIENT SIDE -->
    <section class="card client">
        <h2>
            <div class="icon-box bg-client"><i class="fa-solid fa-desktop"></i></div>
            Passo 2: O Frontend (Client Script)
        </h2>

        <h3>Como criar no ServiceNow</h3>
        <ul class="step-list">
            <li class="step-item">
                <div class="step-num">1</div>
                <div class="step-content">Navegue até <strong>System Definition > Client Scripts</strong>.</div>
            </li>
            <li class="step-item">
                <div class="step-num">2</div>
                <div class="step-content">Clique em <strong>New</strong>.</div>
            </li>
            <li class="step-item">
                <div class="step-num">3</div>
                <div class="step-content">Preencha: Table = <strong>Incident</strong>, Type = <strong>onChange</strong>, Field name = <strong>Caller</strong>.</div>
            </li>
        </ul>

        <div class="code-wrapper">
            <div class="code-header">
                <div class="code-header-info">
                    <span>Client Script</span>
                    <span>Client-Side (Javascript)</span>
                </div>
                <button type="button" class="code-copy-btn" aria-label="Copiar código">
                    <i class="fa-regular fa-copy"></i>
                    <span class="copy-label">Copiar código</span>
                </button>
            </div>
            <pre><code><span class="kwd">function</span> onChange(control, oldValue, newValue, isLoading) {
    <span class="kwd">if</span> (isLoading) <span class="kwd">return</span>;

    <span class="com">// 1. Limpa o campo se o usuário apagar o nome (Evita dados órfãos)</span>
    <span class="kwd">if</span> (newValue === <span class="str">''</span>) {
        g_form.setValue(<span class="str">'u_email'</span>, <span class="str">''</span>);
        <span class="kwd">return</span>;
    }

    <span class="com">// 2. Inicia o GlideAjax com o NOME do Script Include</span>
    <span class="kwd">var</span> ga = <span class="kwd">new</span> <span class="cls">GlideAjax</span>(<span class="str">'UserDataHelper'</span>);
    
    <span class="com">// 3. Define qual FUNÇÃO executar</span>
    ga.addParam(<span class="str">'sysparm_name'</span>, <span class="str">'getEmail'</span>);
    
    <span class="com">// 4. Passa os parâmetros (nome padronizado)</span>
    ga.addParam(<span class="str">'sysparm_user_id'</span>, newValue);
    
    <span class="com">// 5. Executa a chamada assíncrona (getXMLAnswer é o padrão moderno)</span>
    ga.getXMLAnswer(<span class="kwd">function</span>(answer) {
        <span class="com">// Garante que não venha 'null' ou 'undefined'</span>
        g_form.setValue(<span class="str">'u_email'</span>, answer || <span class="str">''</span>);
    });
}</code></pre>
        </div>

        <div class="alert-box">
            <i class="fa-solid fa-triangle-exclamation"></i>
            <div>
                <strong>Dica Pro:</strong> Evite usar <code>ga.getXMLWait()</code>. Isso trava o navegador do usuário até o servidor responder e cria uma péssima experiência de uso.
            </div>
        </div>
    </section>

    <!-- BEST PRACTICES -->
    <section class="card best-practices">
        <h2>
            <div class="icon-box bg-gold"><i class="fa-solid fa-star"></i></div>
            Dicas de Ouro
        </h2>
        <ul class="step-list">
            <li class="step-item">
                <div class="step-num step-num-gold">1</div>
                <div class="step-content">
                    <strong>Use getXMLAnswer:</strong> Antigamente usava-se <code>getXML</code>, que obrigava você a fazer parse de XML na resposta. O <code>getXMLAnswer</code> já entrega a string limpa.
                </div>
            </li>
            <li class="step-item">
                <div class="step-num step-num-gold">2</div>
                <div class="step-content">
                    <strong>JSON para dados complexos:</strong> Se precisar retornar Email, Telefone e Cargo ao mesmo tempo, não faça 3 chamadas GlideAjax. Retorne um objeto JSON (<code>JSON.stringify</code>) e no cliente faça o parse (<code>JSON.parse</code>).
                </div>
            </li>
        </ul>
    </section>

    <!-- OFFICIAL DOCUMENTATION -->
    <section class="card concept docs">
        <h2>
            <div class="icon-box bg-concept"><i class="fa-solid fa-book"></i></div>
            Material de Apoio
        </h2>
        <p class="ga-text-muted ga-mb-md">
            Explore os materiais oficiais e da comunidadepara aprofundar o conhecimento sobre GlideAjax e garantir implementações alinhadas às boas práticas da plataforma.
        </p>
        <ul class="resource-list">
            <li>
                <div>
                    <strong>Documentação oficial</strong>
                    <p>Documentação oficial da Servicenow atualizada sobre GlideAjax, cobrindo métodos, parâmetros e exemplos.</p>
                </div>
                <a href="https://www.servicenow.com/docs/bundle/zurich-api-reference/page/app-store/dev_portal/API_reference/GlideAjax/concept/c_GlideAjaxAPI.html" target="_blank" rel="noopener">Abrir</a>
            </li>
            <li>
                <div>
                    <strong>Artigo da Community sobre GlideAjax</strong>
                    <p>Excelente artigo escrito por <a href="https://www.linkedin.com/in/dowler/" target="_blank" rel="noopener">Shawn Dowler</a> com um exemplo pratico e uma explicação sobre os parametros que facilitam muito o entendimento da estrutura.</p>
                </div>
                <a href="https://www.servicenow.com/community/developer-articles/glideajax-example-cheat-sheet-updated/ta-p/2323817" target="_blank" rel="noopener">Abrir</a>
            </li>
        </ul>
    </section>

    <section class="ga-connect">
        <h2>Vamos nos conectar?</h2>
        <div class="icons contact-page-links">
            <a href="https://www.linkedin.com/in/itallobrandao/" target="_blank" rel="noopener" aria-label="LinkedIn"><i class="bi bi-linkedin"></i></a>
            <a href="https://github.com/IMBrandao" target="_blank" rel="noopener" aria-label="GitHub"><i class="bi bi-github"></i></a>
            <a href="https://www.youtube.com/@BrandaoSN" target="_blank" rel="noopener" aria-label="YouTube"><i class="bi bi-youtube"></i></a>
            <a href="https://api.whatsapp.com/send/?phone=5562999284868&text=Ol%C3%A1%2C%20Brand%C3%A3o!%0ATudo%20bem%3F&type=phone_number&app_absent=0" target="_blank" rel="noopener" aria-label="WhatsApp"><i class="bi bi-whatsapp"></i></a>
        </div>
    </section>

            </div>
        </main>
    </div>
</div>

<div data-include="footer"></div>

<script src="../../js/layout.js"></script>
<script src="../../script.js"></script>
<script src="../../js/glideajax-sim.js"></script>

</body>
</html>
